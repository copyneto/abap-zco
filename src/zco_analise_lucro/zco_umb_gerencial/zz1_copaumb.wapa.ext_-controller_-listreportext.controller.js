sap.ui.define(["sap/ui/export/Spreadsheet","sap/ui/export/library"],function(e,a){"use strict";return sap.ui.controller("br.com.trescoracoes.copaumbapp.ext.controller.ListReportExt",{onActionDownloadLayout:function(s){var t=[];t.push({label:"Familia",pro+
perty:"Familia",type:a.EdmType.String});t.push({label:"Unid. de medida(VV030_ME)",property:"unidadeMedida",type:a.EdmType.String});t.push({label:"Unid. de medida(VV031_ME)",property:"unidadeMedida",type:a.EdmType.String});t.push({label:"Unid. de medida(V+
V032_ME)",property:"unidadeMedida",type:a.EdmType.String});var r={workbook:{columns:t},dataSource:[""],count:1,fileName:"modelo.xlsx"};var i=new e(r);i.build().finally(function(){i.destroy()})},onActionUploadFile:function(e){var a=new sap.m.Dialog({conte+
ntWidth:"300px",resizable:true,type:"Message"});a.setTitle("Carregar arquivo Excel");var s="/sap/opu/odata/SAP/ZCO_UPLOAD_SRV/";var t=new sap.ui.model.odata.ODataModel(s,false);var r=s+"uploadSetUnmedg";var i=new sap.ui.unified.FileUploader({width:"100%"+
,fileType:["xlsx","xls"],typeMissmatch:this.handleTypeMissmatch,uploadComplete:function(e){var s=this.oView.sId+"--responsiveTable";var t=this.byId(s);if(t){t.getModel().refresh(true)}a.close();a.destroy();if(e.mParameters.status=="200"||e.mParameters.st+
atus=="201"){sap.m.MessageToast.show("Carga realizada com sucesso.")}else{if(e.mParameters.response){if(e.mParameters.responseRaw.search("<message>")){var r=null;if(r=e.mParameters.responseRaw.split("<message>").length===1)r=e.mParameters.responseRaw.spl+
it("<message>")[0].split("</message>")[0];else r=e.mParameters.responseRaw.split("<message>")[1].split("</message>")[0];alert(r)}else{alert("Return Code: "+e.mParameters.response,"Response","Response")}}}}.bind(this)});i.setName("Simple Uploader");i.setU+
ploadUrl(r);i.setSendXHR(true);i.setUseMultipart(false);i.setUploadOnChange(false);var o=new sap.ui.unified.FileUploaderParameter({name:"x-csrf-token",value:t.getSecurityToken()});i.insertHeaderParameter(o);var n=new sap.m.Button({text:"Upload",type:"Acc+
ept",press:function(){var e=i.getFocusDomRef();var a=e.files[0];if(i.getValue()===""){sap.m.MessageToast.show("Favor selecionar um arquivo");return}var s=new sap.ui.unified.FileUploaderParameter({name:"Content-Type",value:a.type});i.insertHeaderParameter+
(s);i.insertHeaderParameter(new sap.ui.unified.FileUploaderParameter({name:"SLUG",value:i.getValue()}));i.upload()}.bind(this)});var p=new sap.m.Button({text:"Cancelar",type:"Reject",press:function(){a.close();a.destroy();this.getView().removeAllDependen+
ts()}.bind(this)});a.addContent(i);a.setBeginButton(p);a.setEndButton(n);a.open()},handleTypeMissmatch:function(e){var a=e.getSource().getFileType();jQuery.each(a,function(e,s){a[e]="*."+s});var s=a.join(", ");sap.m.MessageToast.show("Tipo de arquivo *."+
+e.getParameter("fileType")+" não é suportado. Escolha um dos tipos a seguir: "+s)}})});                                                                                                                                                                       