sap.ui.define(["sap/ui/export/Spreadsheet","sap/ui/export/library"],function(e,t){"use strict";return sap.ui.controller("br.com.trescoracoes.okb9.ext.controller.ListReportExt",{onActionDownloadLayout:function(a){var s=[];s.push({label:"Empresa",property:+
"empresa",type:t.EdmType.String});s.push({label:"Classe de Custo",property:"classeCusto",type:t.EdmType.String});s.push({label:"Divisão",property:"divisao",type:t.EdmType.String});s.push({label:"Centro de Lucro",property:"centroLucro",type:t.EdmType.Stri+
ng});s.push({label:"Centro de Custo",property:"centroCusto",type:t.EdmType.String});var r={workbook:{columns:s},dataSource:[""],count:1,fileName:"OKB9.xlsx"};var o=new e(r);o.build().finally(function(){o.destroy()})},onActionUploadFile:function(e){var t=+
new sap.m.Dialog({contentWidth:"300px",resizable:true,type:"Message"});t.setTitle("Carregar arquivo Excel");var a=this.getOwnerComponent().getModel("uploadModel");var s=a.sServiceUrl;var r=s+"/uploadSet";var o=new sap.ui.unified.FileUploader({width:"100%+
",fileType:["xlsx","xls"],typeMissmatch:this.handleTypeMissmatch,uploadComplete:function(e){t.setBusy(false);var a=this.oView.sId+"--responsiveTable";var s=this.byId(a);if(s){s.getModel().refresh(true)}t.close();t.destroy();if(e.mParameters.status=="200"+
||e.mParameters.status=="201"){sap.m.MessageToast.show("Carga realizada com sucesso.")}else{if(e.mParameters.response){if(e.mParameters.responseRaw.search("<message>")){var r=e.mParameters.responseRaw.split("<message>")[1].split("</message>")[0];alert(r)+
}else{alert("Return Code: "+e.mParameters.response,"Response","Response")}}}}.bind(this)});o.setName("Simple Uploader");o.setUploadUrl(r);o.setSendXHR(true);o.setUseMultipart(false);o.setUploadOnChange(false);var i=new sap.ui.unified.FileUploaderParamete+
r({name:"x-csrf-token",value:a.getSecurityToken()});o.insertHeaderParameter(i);var n=new sap.m.Button({text:"Upload",type:"Accept",press:function(){t.setBusy(true);var e=o.getFocusDomRef();var a=e.files[0];if(o.getValue()===""){sap.m.MessageToast.show("F+
avor selecionar um arquivo");return}var s=new sap.ui.unified.FileUploaderParameter({name:"Content-Type",value:a.type});o.insertHeaderParameter(s);o.insertHeaderParameter(new sap.ui.unified.FileUploaderParameter({name:"SLUG",value:o.getValue()}));o.upload+
()}.bind(this)});var p=new sap.m.Button({text:"Cancelar",type:"Reject",press:function(){t.close();t.destroy();this.getView().removeAllDependents()}.bind(this)});t.addContent(o);t.setBeginButton(p);t.setEndButton(n);t.open()},handleTypeMissmatch:function(+
e){var t=e.getSource().getFileType();jQuery.each(t,function(e,a){t[e]="*."+a});var a=t.join(", ");sap.m.MessageToast.show("Tipo de arquivo *."+e.getParameter("fileType")+" não é suportado. Escolha um dos tipos a seguir: "+a)}})});                         